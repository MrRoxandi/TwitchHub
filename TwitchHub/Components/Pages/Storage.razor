<!-- Pages/Storage.razor -->
@page "/storage"
@inject ISnackbar Snackbar

<div class="d-flex justify-space-between align-center mb-4">
    <div>
        <MudText Typo="Typo.h5" Style="font-weight: 700;">Внутреннее Хранилище</MudText>
        <MudText Typo="Typo.body2" Class="mud-text-secondary">Данные, сохраненные через !note</MudText>
    </div>
</div>

<MudGrid Style="height: calc(100vh - 180px);">
    <!-- List -->
    <MudItem xs="12" md="4" Style="height: 100%;">
        <MudPaper Class="d-flex flex-column h-100" Outlined="true" Style="border-color: #27272a;">
            <div class="pa-3 border-b border-solid" style="border-color: #27272a;">
                <MudTextField @bind-Value="_search" Placeholder="Поиск..." Variant="Variant.Outlined" Margin="Margin.Dense" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" />
            </div>
            <MudList T="string" Clickable="true" Class="overflow-y-auto flex-grow-1">
                @foreach (var note in _notes)
                {
                    <MudListItem OnClick="@(() => _selectedNote = note)" Class="@(_selectedNote == note ? "mud-theme-primary-hover" : "")" Style="@(_selectedNote == note ? "background: rgba(6, 182, 212, 0.1); border-left: 3px solid #06b6d4;" : "border-left: 3px solid transparent;")">
                        <div class="d-flex justify-space-between">
                            <MudText Typo="Typo.body2" Style="@(_selectedNote == note ? "color: #06b6d4; font-weight: 600;" : "color: #d4d4d8;")">@note.Title</MudText>
                        </div>
                        <div class="d-flex justify-space-between mt-1">
                            <MudText Typo="Typo.caption" Class="mud-text-secondary">@note.Author</MudText>
                            <MudText Typo="Typo.caption" Class="mud-text-secondary">@note.Date.ToShortDateString()</MudText>
                        </div>
                    </MudListItem>
                    <MudDivider />
                }
            </MudList>
        </MudPaper>
    </MudItem>

    <!-- Detail -->
    <MudItem xs="12" md="8" Style="height: 100%;">
        <MudPaper Class="h-100 d-flex flex-column" Outlined="true" Style="border-color: #27272a; background: #09090b;">
            @if (_selectedNote != null)
            {
                <div class="pa-6 border-b border-solid" style="border-color: #27272a; background: #18181b;">
                    <MudText Typo="Typo.h5" Style="font-family: monospace; font-weight: 700;">@_selectedNote.Title</MudText>
                    <div class="d-flex gap-4 mt-2">
                        <MudChip T="string" Icon="@Icons.Material.Filled.Person" Size="Size.Small" Variant="Variant.Outlined">@_selectedNote.Author</MudChip>
                        <MudChip T="string" Icon="@Icons.Material.Filled.AccessTime" Size="Size.Small" Variant="Variant.Outlined">@_selectedNote.Date</MudChip>
                    </div>
                </div>
                <div class="pa-6 overflow-y-auto">
                    <MudPaper Class="pa-4" Outlined="true" Style="border-color: #27272a; background: #09090b; font-family: monospace; color: #d4d4d8;">
                        @_selectedNote.Content
                    </MudPaper>
                </div>
            }
            else
            {
                <div class="d-flex justify-center align-center h-100 flex-column mud-text-secondary">
                    <MudIcon Icon="@Icons.Material.Filled.Storage" Size="Size.Large" Style="opacity: 0.2; width: 64px; height: 64px;" />
                    <MudText Class="mt-4">Выберите запись для просмотра</MudText>
                </div>
            }
        </MudPaper>
    </MudItem>
</MudGrid>

@code {
    string _search = "";
    NoteItem _selectedNote;
    class NoteItem { public string Title { get; set; } public string Content { get; set; } public string Author { get; set; } public DateTime Date { get; set; } }

    List<NoteItem> _notes = new() {
        new() { Title = "game_idea_1", Content = "Пройти хоррор игру с пульсометром", Author = "Viewer123", Date = DateTime.Now },
        new() { Title = "shop_list", Content = "Новый микрофон, веб-камера, свет", Author = "ModeratorOne", Date = DateTime.Now.AddDays(-1) },
    };
}